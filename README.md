# HS 품목분류 챗봇 🚀

**"복잡한 HS 분류, 이제 AI에게 물어보세요!"**

💼 **무역업 종사자들을 위한 필수 도구**: 수출입 신고 전 HS 코드 확인, 관세율 조회, 분류 근거 확보가 한 번에!  
🎯 **전문가 수준 분석**: 관세청 공식 사례 1,000건+, 해외 분류 사례, HS 해설서를 AI가 종합 분석  
⚡ **즉시 답변**: 복잡한 검색 없이 질문만 하면 실무에 바로 활용 가능한 전문 답변 제공  
🔍 **투명한 과정**: 모든 AI 분석 과정을 실시간으로 공개하여 신뢰성 보장

## 📋 목차
- [핵심 기능](#핵심-기능)
- [설치 및 실행](#설치-및-실행)
- [기능별 사용법](#기능별-사용법)
- [프로젝트 구조](#프로젝트-구조)
- [환경 설정](#환경-설정)

## 🎯 핵심 기능

### 1. **AI 자동분류** 🤖
- **질문 유형 자동 판단**: "이게 어떤 질문인지 몰라도 OK!" - AI가 질문을 분석해 최적 방식 선택
- **5가지 맞춤형 응답**: 웹검색, 국내사례, 해외사례, 해설서분석, 원문검색 중 자동 선택
- **초보자도 쉽게**: 복잡한 메뉴 선택 없이 바로 질문하면 전문가 수준 답변 제공

### 2. **웹 검색** 🌐
- **최신 시장 정보**: "요즘 핫한 이 제품, 어떤 업계 동향일까?" - 실시간 구글 검색으로 최신 정보 제공
- **제품 이해 도우미**: 생소한 제품도 용도, 특징, 시장 현황까지 한 번에 파악
- **무역 트렌드**: 수출입 동향, 관세 변화, 업계 이슈 등 비즈니스 인사이트 제공

### 3. **국내 HS 분류사례 검색** 🇰🇷
- **관세청 공식 사례**: "한국에서는 어떻게 분류하지?" - 관세청 실제 분류 사례 1,000건+ 분석
- **Multi Agents 동시 검색**: 5개 AI가 동시에 검색해서 놓치는 사례 없이 완벽 커버
- **실무 활용도 100%**: 세관 신고 시 바로 활용 가능한 공식 분류 근거 제공

### 4. **해외 HS 분류사례 검색** 🌍
- **글로벌 분류 동향**: "미국/EU에서는 이 제품을 어떻게 보나?" - 해외 관세청 분류 기준 비교
- **수출 준비 필수**: 해외 수출 시 현지 관세청 분류 사례를 미리 파악
- **리스크 대비**: 국가별 분류 차이점과 주의사항을 사전에 확인

### 5. **HS 해설서 분석 (사용자 제시 코드)** 📚
- **사용자 중심 분석**: 사용자가 직접 제시한 HS 코드들을 전문적으로 비교 분석
- **5단계 체계적 분석**: 코드 추출 → 관세율표 정보 → 해설서 수집 → 통칙 준비 → AI 비교 분석
- **투명한 분석 과정**: 각 단계별 진행 상황을 실시간으로 공개
- **전문가 수준 비교**: 여러 HS 코드의 장단점, 적용 가능성, 리스크 등을 종합 평가
- **실무 활용도**: 분류 근거, 주의사항, 대안 코드까지 제시하여 실무 적용 가능

### 6. **HS 해설서 원문 검색** 📖
- **공식 해설서 즉시 조회**: "8517호 정확한 해설이 궁금해" - HS 코드 입력하면 공식 해설서 원문 제공
- **체계적 정리**: 통칙부터 부/류/호 해설까지 순서대로 구조화하여 이해하기 쉽게 표시
- **분류 기준 학습**: HS 분류 원리를 정확히 이해하고 싶을 때 최적

## 🚀 설치 및 실행

### 필수 요구사항
```bash
pip install -r requirements.txt
```

**또는 개별 설치:**
```bash
pip install google-genai
pip install python-dotenv
pip install streamlit
pip install typing-extensions
pip install numpy
pip install pandas
pip install requests
```

### 환경 설정
1. `.env` 파일 생성:
```env
GOOGLE_API_KEY=your_google_api_key_here
```

2. 필요한 데이터 파일들을 `knowledge/` 폴더에 배치:
   - `HS분류사례_part1.json` ~ `HS분류사례_part10.json` (국내 분류사례)
   - `HS위원회.json`, `HS협의회.json` (위원회/협의회 결정)
   - `hs_classification_data_us.json` (미국 관세청 데이터)
   - `hs_classification_data_eu.json` (EU 관세청 데이터)
   - `hstable.json` (관세율표 - 병렬검색용)
   - `통칙_grouped.json` (HS 통칙)
   - `grouped_11_end.json` (HS 해설서)

### 실행
```bash
streamlit run main.py
```

## 📖 기능별 사용법

### 1. AI 자동분류 사용법
**사용 시점**: 어떤 유형의 질문인지 확실하지 않을 때

**예시 질문**:
```
"리튬이온 배터리의 HS 코드가 무엇인가요?"
→ AI가 자동으로 'HS 분류사례 검색'으로 분류하여 답변

"전기차 시장 동향이 궁금합니다"
→ AI가 자동으로 '웹 검색'으로 분류하여 최신 정보 제공
```

**장점**: 
- 질문 유형을 고민할 필요 없음
- 가장 적합한 방식으로 자동 처리

### 2. 웹 검색 사용법
**사용 시점**: 최신 시장 정보, 뉴스, 동향이 필요할 때

**예시 질문**:
```
"2024년 반도체 수출 동향"
"친환경 포장재 시장 현황"
"최근 K-뷰티 제품 해외 진출 동향"
"전기차 배터리 기술 발전 현황"
```

**답변 예시**:
```
+++ 웹검색 실시 +++

2024년 반도체 수출 동향에 대한 최신 정보입니다:

1. 수출 실적
- 2024년 반도체 수출액은 전년 대비 15% 증가
- 메모리 반도체가 전체 수출의 60% 차지

2. 주요 수출국
- 중국 35%, 미국 20%, 일본 15%
- 동남아시아 지역으로의 수출 확대 추세

3. 시장 전망
- AI 반도체 수요 급증으로 지속적 성장 예상
```

### 3. 국내 HS 분류사례 검색 사용법
**사용 시점**: 한국 관세청의 공식 분류 사례가 필요할 때

**예시 질문**:
```
"프로틴 파우더의 HS 코드는?"
"무선 이어폰 HS 분류"
"LED 조명의 품목분류"
"화장품용 세럼 HS 코드"
```

**답변 예시**:
```
+++ HS 분류사례 검색 실시 +++

프로틴 파우더의 HS 분류 분석 결과:

【추천 HS 코드】: 2106.90-9090
【품목 설명】: 기타 조제식료품

【분류 근거】:
1. 관세청 사례 분석
   - 유사 사례: "단백질 보충제 분말" → 2106.90-9090 분류
   - 분류 사유: 단백질 함량이 높은 조제식료품으로 분류

2. 성분 및 용도 고려사항
   - 주성분: 유청단백질, 카제인 등
   - 용도: 운동 후 근육 회복 및 단백질 보충
   - 형태: 분말 형태의 즉석 용해 제품

【관세율】: 기본세율 8%, 협정세율 적용 시 0-5%
【주의사항】: 의약품 성분 함유 시 별도 분류 검토 필요
```

### 4. 해외 HS 분류사례 검색 사용법
**사용 시점**: 미국/EU 관세청 분류 사례나 국제적 동향이 필요할 때

**예시 질문**:
```
"미국에서 전자담배 HS 분류는?"
"EU의 친환경 포장재 HS 코드"
"해외 CBD 오일 품목분류 동향"
"미국 관세청의 스마트워치 분류 사례"
```

**답변 예시**:
```
+++ 해외 HS 분류 검색 실시 +++

미국에서의 전자담배 HS 분류 분석:

【미국 관세청 분류】
- HS 코드: 8543.70-9860
- 분류명: Electronic cigarettes and similar personal electric vaporizing devices

【EU 관세청 분류】
- HS 코드: 8543.70-9000
- 분류명: Electrical machines having individual functions

【국제적 분류 동향】
1. 미국: 전자담배를 전자기기로 분류, 니코틴 함유량에 따라 추가 규제
2. EU: 의료기기 규정과 연계하여 엄격한 분류 기준 적용
3. 캐나다: 담배 대체품으로 분류하여 높은 세율 적용

【한국 분류와의 비교】
- 한국: 8543.70-9000 (기타 전기기기)
- 국제적으로 유사한 분류 체계 유지
```

### 5. HS 해설서 분석 사용법 (사용자 제시 코드)
**사용 시점**: 내가 고민하고 있는 여러 HS 코드 중에서 최적의 코드를 선택하고 싶을 때

**💡 이런 상황에 최적**:
- "8517.12와 8471.30 중 어떤 게 맞을까?"
- "여러 HS 코드를 검토했는데 확신이 서지 않을 때"
- "세무사/관세사와 상담 전에 미리 검토하고 싶을 때"
- "수입 신고 전에 리스크를 미리 파악하고 싶을 때"

**🔄 5단계 전문 분석 프로세스**:
1. **코드 추출**: 사용자 입력에서 HS 코드 자동 인식
2. **관세율표 정보**: 각 코드의 공식 품목명과 세율 정보 수집
3. **해설서 수집**: 관련 통칙, 부/류/호 해설 자동 수집
4. **통칙 준비**: HS 분류 기본 원칙 준비
5. **AI 전문 분석**: 종합적 비교 분석 및 최종 추천

**예시 질문**:
```
"스마트워치가 8517.62(스마트폰)와 9102.11(손목시계) 중 어디에 해당하나요?"
"전기차 충전기가 8504.40과 8544.42 중 어떤 코드인가요?"
"화장품용 세럼이 3304.99와 3307.49 중 맞는 건 뭔가요?"
"LED 스트립 조명이 9405.40과 8539.31 중 어디에 분류되나요?"
```

**답변 예시**:
```
+++ HS 해설서 분석 실시 (사용자 제시 코드) +++

스마트워치 HS 분류 비교 분석 결과:

🎯 【최종 추천】: 8517.62-1000 (무선전화기)
🔍 【확신도】: 높음 (85%)

📊 【코드별 비교 분석】

1️⃣ 8517.62-1000 (무선전화기) ⭐ 추천
   ✅ 장점:
   - 통화, 메시지 기능이 주요 기능
   - 셀룰러 네트워크 연결 기능
   - 스마트폰과 유사한 통신 기기로 분류
   
   ⚠️ 주의사항:
   - 시계 기능은 부차적 기능으로 판단
   - 관세율: 기본 8%, FTA 0-3%

2️⃣ 9102.11-0000 (손목시계)
   ❌ 분류 어려움:
   - 시계 기능이 주요 기능이 아님
   - 통신 기능이 더 중요한 기능
   - 현대적 스마트워치는 통신기기에 가까움
   
   💰 관세율: 기본 8%, FTA 0%

🏛️ 【관세청 분류 기준】
- 통칙 3(다) 적용: 기능이 복합적일 때는 주요 기능 우선
- 스마트워치의 주요 기능은 '통신'으로 판단
- 시계 기능은 부가적 기능으로 분류

⚖️ 【리스크 분석】
- 8517.62 선택 시: 낮은 리스크 (관세청 분류 경향과 일치)
- 9102.11 선택 시: 중간 리스크 (이의제기 가능성)

💼 【실무 조치사항】
1. 8517.62-1000으로 신고 권장
2. 품목 설명란에 "통신 기능 내장" 명시
3. 제품 카탈로그, 기능 설명서 보관
4. 필요시 관세청 사전심사 신청 고려
```

**⏱️ 실시간 분석 과정 공개**:
```
🔍 1단계: HS 코드 추출 중... ✅ 2개 코드 발견
📊 2단계: 관세율표 정보 수집 중... ✅ 완료 (1.2초)
📚 3단계: 해설서 수집 중... ✅ 관련 해설 확보
📋 4단계: 통칙 준비 중... ✅ 분류 원칙 준비 완료
🤖 5단계: AI 전문 분석 중... ✅ 비교 분석 완료 (3.8초)
```

### 6. HS 해설서 원문 검색 사용법
**사용 시점**: 특정 HS 코드의 공식 해설서 원문이 필요할 때

**예시 질문**:
```
"8517"
"HS 2106"
"1234"
"HS1005"
```

**답변 예시**:
```
+++ HS 해설서 원문 검색 실시 +++

# HS 코드 8517 해설

## 📋 해설서 통칙

### 통칙 1
분류는 우선 류와 호의 용어에 따라 결정하고...

### 통칙 2
(a) 완성되지 않은 물품에 대한 언급은...

## 📂 부(部) 해설

제16부 - 기계류, 전기기기와 그 부분품
이 부에는 일반적으로 기계류, 기구, 장치 및 전기기기...

## 📚 류(類) 해설

제85류 - 전기기기와 그 부분품
이 류에는 전기를 발생, 변환, 분배 또는 사용하는 기계와 기구...

## 📝 호(號) 해설

8517호 - 전화기, 기타 음성·영상·기타 자료의 송신용·수신용 기기
이 호에는 전화기와 기타 통신기기가 포함됩니다...

1. 유선전화기
2. 무선전화기 
3. 팩시밀리
4. 텔렉스 단말기
...
```

## 🏗️ 프로젝트 구조

```
HS_Chatbot/
├── main.py                 # Streamlit 메인 애플리케이션 (실시간 로깅 포함)
├── utils.py                # 핵심 기능 및 병렬 검색 시스템
├── hs_search.py            # HS 코드 검색 유틸리티
├── CLAUDE.md              # Claude Code 개발 가이드
├── .env                    # 환경 변수 (API 키)
├── requirements.txt        # 패키지 의존성 목록
├── README.md              # 프로젝트 문서
├── knowledge/             # 핵심 데이터 파일
│   ├── HS분류사례_part1.json ~ part10.json  # 국내 분류사례
│   ├── HS위원회.json, HS협의회.json          # 위원회 결정사항
│   ├── hs_classification_data_us.json       # 미국 관세청 데이터
│   ├── hs_classification_data_eu.json       # EU 관세청 데이터
│   ├── hstable.json                         # 관세율표 (병렬검색)
│   ├── 통칙_grouped.json                     # HS 통칙
│   └── grouped_11_end.json                  # HS 해설서
├── 품목분류표_제작/        # 관세율표 데이터 처리
└── previously/            # 이전 버전 백업
```

## ⚙️ 환경 설정

### 1. Google API 키 발급
1. [Google AI Studio](https://makersuite.google.com/app/apikey) 접속
2. API 키 생성
3. `.env` 파일에 추가

### 2. 데이터 준비
- 관세청 공식 HS 분류 사례 데이터
- 해외 관세청 분류 데이터
- HS 해설서 및 통칙 데이터

### 3. 성능 최적화 및 고급 기능
- **Streamlit 캐싱**: `@st.cache_resource`로 HSDataManager 최적화
- **Multi Agents 시스템**: 대용량 데이터를 5개 그룹으로 병렬 처리
- **병렬 검색 엔진**: 관세율표 + 해설서 동시 검색으로 정확도 향상
- **실시간 로깅**: 모든 AI 처리 과정의 투명한 시각화
- **유사도 기반 매칭**: SequenceMatcher를 활용한 정밀 텍스트 매칭
- **가중치 기반 통합**: 다중 소스 결과의 지능적 결합

## 🤝 기여하기

1. Fork the repository
2. Create your feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit your changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## 📄 라이선스

이 프로젝트는 MIT 라이선스를 따릅니다.

## 📞 문의

프로젝트에 대한 문의사항이나 개선 제안이 있으시면 이슈를 생성해 주세요.

---

**Made with ❤️ for HS Classification Professionals**
